units micro
atom_style hybrid ellipsoid paramagnet bond
boundary s s p
dimension 2
neighbor 4.0 nsq
pair_style hybrid lj/cut/dipole/cut 0 200
bond_style biharmonic

### ---Create Particles and Region--- ###
read_data ./test.lmpdata
  orthogonal box = (-30 -30 -0.02) to (330 330 0.02)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  440 atoms
  scanning bonds ...
  1 = max bonds/atom
  220 ellipsoids
  reading bonds ...
  220 bonds
  1 = max # of 1-2 neighbors
  0 = max # of 1-3 neighbors
  0 = max # of 1-4 neighbors
  1 = max # of special neighbors
  special bonds CPU = 8.60691e-05 secs
  read_data CPU = 0.00273705 secs
group Atoms type 1
220 atoms in group Atoms
group Traps type 2
110 atoms in group Traps

group Traps type 3
220 atoms in group Traps
mass * 1
group Atoms_1 type 1
220 atoms in group Atoms_1

### ---Variables--- ###

## magnetic field
variable Bmag atom 5.322907795715563e-05
variable freq atom 0.0
variable theta atom 0.0
variable phi atom 0.0

variable fieldx atom v_Bmag*cos(v_freq*time*2*PI+v_phi)*sin(v_theta)
variable fieldy atom v_Bmag*sin(v_freq*time*2*PI+v_phi)*sin(v_theta)
variable fieldz atom v_Bmag*cos(v_theta)

### ---Fixes--- ###

fix 	1 Atoms setdipole v_fieldx v_fieldy v_fieldz 0
fix 	2 Atoms bd 300 0.001 432408

fix 	3 Atoms addforce 0 0 -0.0

fix 	5 all enforce2d_bd

###Â ---Run Commands--- ###
timestep 	10000.0
dump 	3 all custom 10 ./test.lammpstrj id type x	 y	 z	 mux	 muy	 muz
thermo_style 	custom step atoms
thermo 	100
run 	1000
Neighbor list info ...
  update every 1 steps, delay 10 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 204
  ghost atom cutoff = 204
  3 neighbor lists, perpetual/occasional/extra = 3 0 0
  (1) pair lj/cut/dipole/cut, perpetual, skip from (3)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
  (2) fix setdipole, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (3) neighbor class addition, perpetual, half/full from (2)
      attributes: half, newton on
      pair build: halffull/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 8.415 | 8.415 | 8.415 Mbytes
Step Atoms 
       0      440 
     100      440 
     200      440 
     300      440 
     400      440 
     500      440 
     600      440 
     700      440 
     800      440 
     900      440 
    1000      440 
Loop time of 1.54744 on 1 procs for 1000 steps with 440 atoms

Performance: 558340811920051.000 ns/day, 0.000 hours/ns, 646.228 timesteps/s
73.8% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.3092     | 1.3092     | 1.3092     |   0.0 | 84.61
Bond    | 0.013472   | 0.013472   | 0.013472   |   0.0 |  0.87
Neigh   | 0.012482   | 0.012482   | 0.012482   |   0.0 |  0.81
Comm    | 0.00048161 | 0.00048161 | 0.00048161 |   0.0 |  0.03
Output  | 0.087485   | 0.087485   | 0.087485   |   0.0 |  5.65
Modify  | 0.12157    | 0.12157    | 0.12157    |   0.0 |  7.86
Other   |            | 0.002727   |            |       |  0.18

Nlocal:    440 ave 440 max 440 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    16423 ave 16423 max 16423 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  32846 ave 32846 max 32846 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 32846
Ave neighs/atom = 74.65
Ave special neighs/atom = 1
Neighbor list builds = 10
Dangerous builds = 1
Total wall time: 0:00:01
