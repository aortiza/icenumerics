units micro
atom_style hybrid ellipsoid paramagnet bond
boundary s s p
dimension 2
neighbor 1.0 nsq
neigh_modify every 1 delay 1 check yes
pair_style hybrid lj/cut/dipole/cut 0 20
bond_style biharmonic

### ---Create Particles and Region--- ###
read_data ./test.lmpdata
  orthogonal box = (-27.5 -25.1554 -0.02) to (360 297.953 0.02)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  678 atoms
  scanning bonds ...
  1 = max bonds/atom
  339 ellipsoids
  reading bonds ...
  339 bonds
  1 = max # of 1-2 neighbors
  0 = max # of 1-3 neighbors
  0 = max # of 1-4 neighbors
  1 = max # of special neighbors
  special bonds CPU = 0.000225067 secs
  read_data CPU = 0.00871015 secs
group Atoms type 1
339 atoms in group Atoms
group Traps type 2
339 atoms in group Traps
mass * 1
group Atoms_1 type 1
339 atoms in group Atoms_1

### ---Variables--- ###

## magnetic field
variable Bmag atom 2.6614538978577816e-05
variable freq atom 0.0
variable theta atom 0.0
variable phi atom 0.0

variable fieldx atom v_Bmag*cos(v_freq*time*2*PI+v_phi)*sin(v_theta)
variable fieldy atom v_Bmag*sin(v_freq*time*2*PI+v_phi)*sin(v_theta)
variable fieldz atom v_Bmag*cos(v_theta)

### ---Fixes--- ###

fix 	1 Atoms setdipole v_fieldx v_fieldy v_fieldz 0
fix 	2 Atoms bd 300 0.001 685543

fix 	3 Atoms addforce 0 0 -0.0

fix 	5 all enforce2d_bd

###Â ---Run Commands--- ###
timestep 	10000.0
dump 	3 all custom 100 ./test.lammpstrj id type x	 y	 z
thermo_style 	custom step atoms
thermo 	100
run 	6000
Neighbor list info ...
  update every 1 steps, delay 1 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 21
  ghost atom cutoff = 21
  3 neighbor lists, perpetual/occasional/extra = 3 0 0
  (1) pair lj/cut/dipole/cut, perpetual, skip from (3)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
  (2) fix setdipole, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (3) neighbor class addition, perpetual, half/full from (2)
      attributes: half, newton on
      pair build: halffull/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 8.43 | 8.43 | 8.43 Mbytes
Step Atoms 
       0      678 
     100      678 
     200      678 
     300      678 
     400      678 
     500      678 
     600      678 
     700      678 
     800      678 
     900      678 
    1000      678 
    1100      678 
    1200      678 
    1300      678 
    1400      678 
    1500      678 
    1600      678 
    1700      678 
    1800      678 
    1900      678 
    2000      678 
    2100      678 
    2200      678 
    2300      678 
    2400      678 
    2500      678 
    2600      678 
    2700      678 
    2800      678 
    2900      678 
    3000      678 
    3100      678 
    3200      678 
    3300      678 
    3400      678 
    3500      678 
    3600      678 
    3700      678 
    3800      678 
    3900      678 
    4000      678 
    4100      678 
    4200      678 
    4300      678 
    4400      678 
    4500      678 
    4600      678 
    4700      678 
    4800      678 
    4900      678 
    5000      678 
    5100      678 
    5200      678 
    5300      678 
    5400      678 
    5500      678 
    5600      678 
    5700      678 
    5800      678 
    5900      678 
    6000      678 
Loop time of 1.6153 on 1 procs for 6000 steps with 678 atoms

Performance: 3209318662036536.000 ns/day, 0.000 hours/ns, 3714.489 timesteps/s
94.4% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.21841    | 0.21841    | 0.21841    |   0.0 | 13.52
Bond    | 0.071442   | 0.071442   | 0.071442   |   0.0 |  4.42
Neigh   | 0.88147    | 0.88147    | 0.88147    |   0.0 | 54.57
Comm    | 0.0030804  | 0.0030804  | 0.0030804  |   0.0 |  0.19
Output  | 0.035147   | 0.035147   | 0.035147   |   0.0 |  2.18
Modify  | 0.3823     | 0.3823     | 0.3823     |   0.0 | 23.67
Other   |            | 0.02343    |            |       |  1.45

Nlocal:    678 ave 678 max 678 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    636 ave 636 max 636 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  1272 ave 1272 max 1272 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1272
Ave neighs/atom = 1.87611
Ave special neighs/atom = 1
Neighbor list builds = 551
Dangerous builds = 1
Total wall time: 0:00:01
