<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Vertex Classification &#8212; icenumerics v0.1.9 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=039e1c02" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script src="../_static/documentation_options.js?v=7dac1a1e"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Forces in the simulation" href="ForcesOfTheSimulation.html" />
    <link rel="prev" title="Read colloidal ice from simulation or experimental data" href="ReadingColloidsFromSimulation.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="Vertex-Classification">
<h1>Vertex Classification<a class="headerlink" href="#Vertex-Classification" title="Link to this heading">¶</a></h1>
<p>The most common type of analysis that we want to do with a colloidal ice system is to map it to a system of vertices, for which we can then classify and count types of vertices.</p>
<p>A system of vertices is a directed network. A vertex geometry is a set of points <span class="math notranslate nohighlight">\(\mathbf{v}_i \in \mathbb{V}\)</span> which define the vertex locations in 3D space. The topology of the vertices is defined by their connectivity; two vertices, <span class="math notranslate nohighlight">\(v_i\)</span> and <span class="math notranslate nohighlight">\(v_j\)</span> are connected if they are joined by an edge <span class="math notranslate nohighlight">\(\mathbf{e}_{ij} = \left(v_i, v_j\right)\)</span>, and the set of all edges is <span class="math notranslate nohighlight">\(\mathbb{E}\)</span>. The vertex network is directed, which means that the edge
<span class="math notranslate nohighlight">\(\mathbf{e}_{ij} \neq \mathbf{e}_{ji}\)</span>.</p>
<p>The mapping from a colloidal ice consists on assigning an edge to each trap. An edge’s direction goes from the vertex with a hole to the vertex with a particle.</p>
<p>A vertex object ‘v’ should be able to guess the vertex geometry and topology that maps a colloidal ice object ‘col’ for simple systems by writing:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>v.colloids_to_vertices(col)
</pre></div>
</div>
<p>However, some assistance on this guessing could be useful. For example: * A set of points containing the vertex positions * A topology, codified as a list of edges forming a vertex.</p>
<p>The vertices object should also keep its topology stored internally. Obtaining the vertex classification for a new frame should be an update, and not a processing from scratch. This means that the processing might not work for dynamic systems where vertices move, or topologies change. That’s fine, we can’t even do that in simulation yet for most systems.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This only adds the package to the path.</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;../../../&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">icenumerics</span> <span class="k">as</span> <span class="nn">ice</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.spatial</span> <span class="k">as</span> <span class="nn">spa</span>

<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
<section id="We-first-create-a-colloidal-ice-to-play-around-with">
<h2>We first create a colloidal ice to play around with<a class="headerlink" href="#We-first-create-a-colloidal-ice-to-play-around-with" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ureg</span> <span class="o">=</span> <span class="n">ice</span><span class="o">.</span><span class="n">ureg</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp</span> <span class="o">=</span> <span class="n">ice</span><span class="o">.</span><span class="n">spins</span><span class="p">()</span>
<span class="n">sp</span><span class="o">.</span><span class="n">create_lattice</span><span class="p">(</span><span class="s2">&quot;square&quot;</span><span class="p">,[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="n">lattice_constant</span><span class="o">=</span><span class="mi">30</span><span class="o">*</span><span class="n">ureg</span><span class="o">.</span><span class="n">um</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;closed spin&quot;</span><span class="p">)</span>

<span class="n">particle</span> <span class="o">=</span> <span class="n">ice</span><span class="o">.</span><span class="n">particle</span><span class="p">(</span><span class="n">radius</span> <span class="o">=</span> <span class="mf">5.15</span><span class="o">*</span><span class="n">ureg</span><span class="o">.</span><span class="n">um</span><span class="p">,</span>
             <span class="n">susceptibility</span> <span class="o">=</span> <span class="mf">0.0576</span><span class="p">,</span>
             <span class="n">diffusion</span> <span class="o">=</span> <span class="mf">0.125</span><span class="o">*</span><span class="n">ureg</span><span class="o">.</span><span class="n">um</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">ureg</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
             <span class="n">temperature</span> <span class="o">=</span> <span class="mi">300</span><span class="o">*</span><span class="n">ureg</span><span class="o">.</span><span class="n">K</span><span class="p">,</span>
             <span class="n">density</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">*</span><span class="n">ureg</span><span class="o">.</span><span class="n">kg</span><span class="o">/</span><span class="n">ureg</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>

<span class="n">trap</span> <span class="o">=</span> <span class="n">ice</span><span class="o">.</span><span class="n">trap</span><span class="p">(</span><span class="n">trap_sep</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ureg</span><span class="o">.</span><span class="n">um</span><span class="p">,</span>
               <span class="n">height</span> <span class="o">=</span> <span class="mi">80</span><span class="o">*</span><span class="n">ureg</span><span class="o">.</span><span class="n">pN</span><span class="o">*</span><span class="n">ureg</span><span class="o">.</span><span class="n">nm</span><span class="p">,</span>
               <span class="n">stiffness</span> <span class="o">=</span> <span class="mf">6e-4</span><span class="o">*</span><span class="n">ureg</span><span class="o">.</span><span class="n">pN</span><span class="o">/</span><span class="n">ureg</span><span class="o">.</span><span class="n">nm</span><span class="p">)</span>

<span class="n">col</span> <span class="o">=</span> <span class="n">ice</span><span class="o">.</span><span class="n">colloidal_ice</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="n">trap</span><span class="p">,</span> <span class="n">height_spread</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">susceptibility_spread</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">col</span><span class="o">.</span><span class="n">pad_region</span><span class="p">(</span><span class="mi">30</span><span class="o">*</span><span class="n">ureg</span><span class="o">.</span><span class="n">um</span><span class="p">)</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li><p>Vertices should work if I calculate them here, before the colloidal_ice has a trj object.</p></li>
<li><p>Maybe the colloidal_ice object should keep a trj dataframe to begin with.</p></li>
<li><p>Also, it occurs to me that the standard trj object stored by colloidal ice shouldn’t be directly read from the lammpstrj, but instead should be processed to a trj object containing directions and colloids. This might be part of creating a <em>results</em> object.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">world</span> <span class="o">=</span> <span class="n">ice</span><span class="o">.</span><span class="n">world</span><span class="p">(</span>
    <span class="n">field</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">ureg</span><span class="o">.</span><span class="n">mT</span><span class="p">,</span>
    <span class="n">temperature</span> <span class="o">=</span> <span class="mi">300</span><span class="o">*</span><span class="n">ureg</span><span class="o">.</span><span class="n">K</span><span class="p">,</span>
    <span class="n">dipole_cutoff</span> <span class="o">=</span> <span class="mi">200</span><span class="o">*</span><span class="n">ureg</span><span class="o">.</span><span class="n">um</span><span class="p">)</span>

<span class="n">col</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">world</span><span class="p">,</span>
             <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>
             <span class="n">include_timestamp</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">targetdir</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
             <span class="n">framerate</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ureg</span><span class="o">.</span><span class="n">Hz</span><span class="p">,</span>
             <span class="n">timestep</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ureg</span><span class="o">.</span><span class="n">ms</span><span class="p">,</span>
             <span class="n">run_time</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ureg</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
             <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span><span class="s2">&quot;y&quot;</span><span class="p">,</span><span class="s2">&quot;z&quot;</span><span class="p">,</span><span class="s2">&quot;mux&quot;</span><span class="p">,</span><span class="s2">&quot;muy&quot;</span><span class="p">,</span><span class="s2">&quot;muz&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
scanning file
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">col</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">ax2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">trj_i</span> <span class="ow">in</span> <span class="n">col</span><span class="o">.</span><span class="n">trj</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">trj_i</span><span class="o">.</span><span class="n">type</span><span class="o">==</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trj_i</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">trj_i</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/OtherNotebooks_VerticesClassification_9_0.png" src="../_images/OtherNotebooks_VerticesClassification_9_0.png" />
</div>
</div>
<section id="Create-a-'vertex'-object-from-a-'colloidal_ice'-object">
<h3>Create a ‘vertex’ object from a ‘colloidal_ice’ object<a class="headerlink" href="#Create-a-'vertex'-object-from-a-'colloidal_ice'-object" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">ice</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="n">v</span><span class="o">.</span><span class="n">colloids_to_vertices</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "6a5b41a5075e470da567fb04987c2975", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c9ae0999bbe54410af9c947b8f48467a", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;icenumerics.vertices.vertices at 0x13a499460&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">v</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">col</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">ax1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/OtherNotebooks_VerticesClassification_12_0.png" src="../_images/OtherNotebooks_VerticesClassification_12_0.png" />
</div>
</div>
</section>
<section id="Create-a-vertex-structure-from-the-results-of-lammps.">
<h3>Create a vertex structure from the results of lammps.<a class="headerlink" href="#Create-a-vertex-structure-from-the-results-of-lammps." title="Link to this heading">¶</a></h3>
<p>We can get the vertex structure from a trajectory. To do this, the trajectory must be in the ‘ice’ format obtained by ‘get_ice_trj’:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trj</span> <span class="o">=</span> <span class="n">ice</span><span class="o">.</span><span class="n">get_ice_trj</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">trj</span><span class="p">,</span> <span class="n">bounds</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">bnd</span><span class="p">)</span>
<span class="n">trj</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>type</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
      <th>dx</th>
      <th>dy</th>
      <th>dz</th>
      <th>t</th>
      <th>cx</th>
      <th>cy</th>
      <th>cz</th>
    </tr>
    <tr>
      <th>frame</th>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">0</th>
      <th>0</th>
      <td>2</td>
      <td>15.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>45.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>75.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>105.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>135.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Notice that in this format, the columns contain the directions and colloid positions of the traps.</p>
<p>The ‘vertex’ class can process the results of a single frame, by giving it as an input a trajectory with a single index.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">ice</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="n">frame</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">trj_to_vertices</span><span class="p">(</span><span class="n">trj</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">frame</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7449930e8ccc4bc8885d27d89375416a", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ef6c3b9cad3d4bfb91dc6913985b4c51", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">v</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">col</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">ax1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/OtherNotebooks_VerticesClassification_19_0.png" src="../_images/OtherNotebooks_VerticesClassification_19_0.png" />
</div>
</div>
</section>
</section>
<section id="Multiple-frames">
<h2>Multiple frames<a class="headerlink" href="#Multiple-frames" title="Link to this heading">¶</a></h2>
<p>If the ‘trj’ is a MultiIndex, the ‘trj_to_vertices’ method will iterate over all the indices which are not ‘id’, and calculate the vertex structure of all frames. However, it will only calculate the topology of the first frame.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">ice</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="n">frames</span> <span class="o">=</span> <span class="n">trj</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s2">&quot;frame&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="n">v</span><span class="o">.</span><span class="n">trj_to_vertices</span><span class="p">(</span><span class="n">trj</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">frames</span><span class="p">[:]])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9bd54280cb4e4e4fa3414880305d23e4", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "870a10a802e84b50b2e5f45a5ce64d29", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "6b9f1dc3f66c4c7483635aa5028d9eb4", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CPU times: user 29.8 s, sys: 1.38 s, total: 31.2 s
Wall time: 32.3 s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;icenumerics.vertices.vertices at 0x13a888d00&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>coordination</th>
      <th>charge</th>
      <th>dx</th>
      <th>dy</th>
    </tr>
    <tr>
      <th>frame</th>
      <th>vertex</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">0</th>
      <th>0</th>
      <td>0.0</td>
      <td>210.0</td>
      <td>3</td>
      <td>-1</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>300.0</td>
      <td>30.0</td>
      <td>3</td>
      <td>1</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>30.0</td>
      <td>0.0</td>
      <td>3</td>
      <td>-1</td>
      <td>2.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>180.0</td>
      <td>300.0</td>
      <td>3</td>
      <td>1</td>
      <td>2.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>210.0</td>
      <td>300.0</td>
      <td>3</td>
      <td>1</td>
      <td>2.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">v</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">col</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">ax1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/OtherNotebooks_VerticesClassification_24_0.png" src="../_images/OtherNotebooks_VerticesClassification_24_0.png" />
</div>
</div>
<section id="Classifying-and-Counting-vertices.">
<h3>Classifying and Counting vertices.<a class="headerlink" href="#Classifying-and-Counting-vertices." title="Link to this heading">¶</a></h3>
<p>From the previous vertex object, where the trayectory of the vertices have been calculated (the time evolution of the vertices) we can then classify and count the vertices using the following procedures:</p>
<p>First we define a function that classifes the vertices. This means taking properties that have been calculated like charge, coordination or dipole, and asigning a “type”. It’s advisable to make the type an integer.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">classify_vertices</span><span class="p">(</span><span class="n">vrt</span><span class="p">):</span>
    <span class="n">vrt</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span>

    <span class="n">vrt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">vrt</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s2">&quot;coordination==4 &amp; charge == -4&quot;</span><span class="p">),</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">vrt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">vrt</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s2">&quot;coordination==4 &amp; charge == -2&quot;</span><span class="p">),</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">vrt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">vrt</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s2">&quot;coordination==4 &amp; charge == 0 &amp; (dx**2+dy**2)==0&quot;</span><span class="p">),</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">vrt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">vrt</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s2">&quot;coordination==4 &amp; charge == 0 &amp; (dx**2+dy**2)&gt;0&quot;</span><span class="p">),</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">vrt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">vrt</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s2">&quot;coordination==4 &amp; charge == 2&quot;</span><span class="p">),</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">vrt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">vrt</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s2">&quot;coordination==4 &amp; charge == 4&quot;</span><span class="p">),</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="k">return</span> <span class="n">vrt</span>

<span class="n">v</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">classify_vertices</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now, we can use the builtin function <code class="docutils literal notranslate"><span class="pre">count_vertices</span></code>, which takes a column, and get’s the total number o vertices for which the given column is of a given unique value.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">count</span> <span class="o">=</span> <span class="n">ice</span><span class="o">.</span><span class="n">count_vertices</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">v_t</span> <span class="ow">in</span> <span class="n">count</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v_t</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s2">&quot;frame&quot;</span><span class="p">),</span> <span class="n">v_t</span><span class="o">.</span><span class="n">fraction</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">t</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x13a7f9400&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/OtherNotebooks_VerticesClassification_30_1.png" src="../_images/OtherNotebooks_VerticesClassification_30_1.png" />
</div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">icenumerics</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../IceNumericsUsage.html">Usage instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Units.html">About units.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Pandas.html">The multiindex pandas array</a></li>
<li class="toctree-l1"><a class="reference internal" href="ReadingColloidsFromSimulation.html">Read colloidal ice from simulation or experimental data</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Vertex Classification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#We-first-create-a-colloidal-ice-to-play-around-with">We first create a colloidal ice to play around with</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Multiple-frames">Multiple frames</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ForcesOfTheSimulation.html">Forces in the simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="CalculateEnergy.html">Calculate Energy</a></li>
<li class="toctree-l1"><a class="reference internal" href="CalculateEnergy.html#Calculate-the-energy-of-a-configuration.">Calculate the energy of a configuration.</a></li>
<li class="toctree-l1"><a class="reference internal" href="SimulationsWithVariableField.html">Running simulations with a field that is a function of time</a></li>
<li class="toctree-l1"><a class="reference internal" href="PolydisperseSystems.html">We first create a colloidal ice to play around with</a></li>
<li class="toctree-l1"><a class="reference internal" href="PolydisperseSystems.html#Multiple-frames">Multiple frames</a></li>
<li class="toctree-l1"><a class="reference internal" href="../API.html">The <cite>icenumerics</cite> API</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="ReadingColloidsFromSimulation.html" title="previous chapter">Read colloidal ice from simulation or experimental data</a></li>
      <li>Next: <a href="ForcesOfTheSimulation.html" title="next chapter">Forces in the simulation</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Antonio Ortiz-Ambriz.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/OtherNotebooks/VerticesClassification.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>